# PHRApp プロジェクトフェーズ計画

このドキュメントでは、PHRAppの全体的な開発計画と各フェーズの主要タスクを概説します。

## フェーズ 1：コア認証＆データ同期（1〜2週間）

### 主要タスク
- **ユーザー登録／ログイン機能**
  - Firebase Auth（メール＆パス）を画面に組み込む
  - サインアップ後、Firestore にユーザー基本情報ドキュメントを生成

- **歩数・体重データの自動取得**
  - Expo Health（iOS）／Google Fit（Android）連携のラッパーを実装
  - 取得した数値をローカル State に反映し、Firestore の userMetrics/{userId}/{date} に保存

- **API キー管理の確認**

- **実機での動作確認**
  - クラッシュが出ないかチェック

- **最低限のエラーハンドリング**
  - 認証エラー、パーミッション拒否時の UI フローを用意

**目標達成状態**: 自分のデータをクラウドに上げられる状態

## フェーズ 2：週次ダッシュボード＆小さな勝利バッジ（1週間）

### 主要タスク
- **ダッシュボード画面（Weekly View）**
  - React Native Chart Kit で、7日間の歩数・体重推移グラフを実装

- **"+1％ 改善" バッジロジック**
  - 前週比で歩数か体重のどちらかが「1％以上改善」していたらバッジ表示
  - バッジ取得履歴を Firestore のコレクションに記録

- **UI/UX チェック**
  - スマホ実機で見栄えを確認し、必要ならセルフレビューorデザイナーレビュー

**目標達成状態**: MVPの顔であるダッシュボードで'スモールウィン'が見える化可能な状態

## フェーズ 3：JIT 通知基盤＆ルール実装（1週間）

### 主要タスク
- **サーバーサイドの Cloud Functions**
  - checkDailySteps をベースに、週次／目標未達通知も追加

- **クライアントでの通知受信**
  - expo-notifications を使い、アプリ起動中／バックグラウンドで通知をキャッチ

- **通知タップで深掘り画面へ誘導**
  - 通知 Deep Link → アプリの特定画面（例：ダッシュボード or チャット画面）を開く

- **通知効果測定**
  - Firestore に「通知発行／タップ」イベントを記録して、クリック率を可視化

**目標達成状態**: 必要なときに、適切な声かけが動く仕組みが完成した状態

## フェーズ 4：AI チャット（GPT-4o）統合（1〜2週間）

### 主要タスク
- **チャット UI**
  - シンプルな 1:1 チャット UI を実装

- **API ブリッジ**
  - OpenAI SDK or fetch で Cloud Function 経由／直接 GPT-4o 呼び出し
  - System Prompt に「動機づけ面接ガイド」などをセット

- **利用制限ロジック**
  - 1日あたり 5 往復まで／1週間20往復までなど、無料枠を踏まえた制御

- **エラー時フォールバック**
  - API 過負荷やエラー時に「後ほど再度お試しください」といった UX

**目標達成状態**: AIコーチが最低限会話できる状態

## フェーズ 5：品質向上＆リリース準備（1週間）

### 主要タスク
- **UI/UX 微調整**
  - アニメーションやマージン調整、ボタンのタップ領域拡大など

- **E2E テスト**
  - Detox や Cypress で重要フロー（登録→同期→バッジ取得→通知）を自動化

- **CI/CD パイプライン**
  - GitHub Actions でプッシュ時にビルド＆Eslint／TypeScript チェック

- **Beta リリース**
  - TestFlight／Android 内部テストトラックでユーザー招待
  - 最初の数名に使ってもらい、定性的フィードバックを収集

**目標達成状態**: 社内 or クローズドユーザーへのテスト提供が可能な状態